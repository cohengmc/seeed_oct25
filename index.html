<!DOCTYPE html>
<html>
<head>
  <title>XIAO IMU Data</title>
</head>
<body>
  <h1>XIAO IMU Data</h1>
  <button id="connectButton">Connect to XIAO</button>
  <div id="imuData"></div>

  <script>
    const connectButton = document.getElementById('connectButton');
    const imuDataContainer = document.getElementById('imuData');

    connectButton.addEventListener('click', () => {
      navigator.bluetooth.requestDevice({
        filters: [{ name: 'XIAO_IMU' }],
        optionalServices: ['19b10000-e8f2-537e-4f6c-d104768a1214']
      })
      .then(device => {
        return device.gatt.connect();
      })
      .then(server => {
        return server.getPrimaryService('19b10000-e8f2-537e-4f6c-d104768a1214');
      })
      .then(service => {
        return service.getCharacteristic('19b10001-e8f2-537e-4f6c-d104768a1214');
      })
      .then(characteristic => {
        characteristic.startNotifications();
        characteristic.addEventListener('characteristicvaluechanged', handleCharacteristicValueChanged);
      })
      .catch(error => {
        console.error(error);
      });
    });

    function handleCharacteristicValueChanged(event) {
      const value = event.target.value;
      const decoder = new TextDecoder('utf-8');
      const imuDataString = decoder.decode(value);
      const imuDataArray = imuDataString.split(',');

      imuDataContainer.innerHTML = `
        <p>X: ${imuDataArray[0]}</p>
        <p>Y: ${imuDataArray[1]}</p>
        <p>Z: ${imuDataArray[2]}</p>
      `;
    }
  </script>
</body>
</html>